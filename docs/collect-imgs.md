# 学習用データの元となる画像の収集

`tools/data_collector/`以下に、画像収集補助ツールが実装されている。

* [Yahoo!画像検索を使う場合](#yahoo画像検索を使う場合)
* [Google画像検索を使う場合](#google画像検索を使う場合)
* [備考](#備考)

## Yahoo!画像検索を使う場合

### 1. 収集対象人物の名前を記載したTSVファイルを作成

`データラベル<tab>人物名`を1行とするTSVファイルを作成する。  
行頭が`#`の行はコメントとして無視される。  
例:

```
# 政治家をデータセットとする場合
0	安倍晋三
1	小池百合子
```

### 2. User-Agentの設定

`collect_img.py`内の`MY_EMAIL_ADDR`に、自分の連絡先を設定する。  
設定した内容は、画像をクロールする際のUser-Agentとして使用される。  

### 3. `collect_img.py`を実行

必要なパッケージがインストールされたvirtualenvを有効化した状態で、  
TSVファイルを第一引数に`collect_img.py`を実行する。  
`python collect_img.py <1.で作成したTSV>`

対象人物でYahoo!画像検索を行い、得られた画像を`imgs/orig/<データラベル>/`以下にダウンロードする。  
1人あたり最大60枚の画像が得られる。

## Google画像検索を使う場合

### 1. chrome-extensionをインストール

Google画像検索はプログラムからのリクエストを拒否するようになっているため、  
Google画像検索の画面から画像URLを取り出す補助ツールをChromeの拡張機能として実装している。

Chromeブラウザの `設定 > 拡張機能 > パッケージ化されていない拡張機能を読み込む` で、  
`tools/data_collector/chrome-extension`を指定する。

### 2. 画像URLリストの作成

拡張機能を有効化した状態で、収集対象とする人物をGoogle画像検索する。  
自動追加読み込みが行われなくなるまで下にスクロールし、  
左下に表示されている`copy img urls`ボタンを押下すると、  
`人物名<tab>画像URL`を1行として400行の画像URLがクリップボードにコピーされる。  
クリップボードの内容をテキストファイルに保存する。  
複数人物の画像URLを取得する場合、1つのテキストファイルに追記する形で保存する。

この作業を、全対象人物の画像URLが得られるまで繰り返す。

### 3. User-Agentの設定

`dl_imgs.py`の`MY_EMAIL_ADDR`に、自分の連絡先を設定する。  
設定した内容は、画像をクロールする際のUser-Agentとして使用される。  

### 4. 画像のダウンロード

必要なパッケージがインストールされたvirtualenvを有効化した状態で、  
TSVファイルを第一引数に`dl_imgs.py`を実行する。  
`python dl_imgs.py <2.で作成したTSV>`

## 備考

* Google画像検索を使う方が1人あたり画像数が多くなるが、手間がかかる。  
* 製作者がGoogle画像検索で作成した121人分の画像URLのファイルが`tools/data_collector/collected_urls.tsv`である。  
収集された画像そのものは、著作権・肖像権の問題から公開しない。
